// Configures Revapi (https://revapi.org/getting-started.html) to check API compatibility between
// successive driver versions.
{
  "revapi": {
    "java": {
      "filter": {
        "packages": {
          "regex": true,
          "exclude": [
            "com\\.datastax\\.oss\\.driver\\.internal\\..*",
            "com\\.datastax\\.oss\\.driver\\.shaded\\..*"
            ]
        }
      }
    },
      "ignore": [
        {
          "code": "java.method.addedToInterface",
          "new": "method boolean com.datastax.oss.driver.api.core.metadata.schema.KeyspaceMetadata::isVirtual()",
          "package": "com.datastax.oss.driver.api.core.metadata.schema",
          "classQualifiedName": "com.datastax.oss.driver.api.core.metadata.schema.KeyspaceMetadata",
          "classSimpleName": "KeyspaceMetadata",
          "methodName": "isVirtual",
          "newArchive": "com.datastax.oss:java-driver-core:jar:4.0.0-beta2-SNAPSHOT",
          "elementKind": "method",
          "justification": "Adding virtual tables"
        },
        {
          "code": "java.method.returnTypeChanged",
          "old": "method java.util.UUID com.datastax.oss.driver.api.core.metadata.schema.RelationMetadata::getId()",
          "new": "method java.util.Optional<java.util.UUID> com.datastax.oss.driver.api.core.metadata.schema.RelationMetadata::getId()",
          "oldType": "java.util.UUID",
          "newType": "java.util.Optional<java.util.UUID>",
          "package": "com.datastax.oss.driver.api.core.metadata.schema",
          "classQualifiedName": "com.datastax.oss.driver.api.core.metadata.schema.RelationMetadata",
          "classSimpleName": "RelationMetadata",
          "methodName": "getId",
          "oldArchive": "com.datastax.oss:java-driver-core:jar:4.0.0-beta1",
          "newArchive": "com.datastax.oss:java-driver-core:jar:4.0.0-beta2-SNAPSHOT",
          "elementKind": "method",
          "justification": "Adding virtual tables"
        },
        {
          "code": "java.annotation.removed",
          "old": "method java.util.UUID com.datastax.oss.driver.api.core.metadata.schema.RelationMetadata::getId()",
          "new": "method java.util.Optional<java.util.UUID> com.datastax.oss.driver.api.core.metadata.schema.RelationMetadata::getId()",
          "annotationType": "edu.umd.cs.findbugs.annotations.NonNull",
          "annotation": "@edu.umd.cs.findbugs.annotations.NonNull",
          "package": "com.datastax.oss.driver.api.core.metadata.schema",
          "classQualifiedName": "com.datastax.oss.driver.api.core.metadata.schema.RelationMetadata",
          "classSimpleName": "RelationMetadata",
          "methodName": "getId",
          "oldArchive": "com.datastax.oss:java-driver-core:jar:4.0.0-beta1",
          "elementKind": "method",
          "justification":"Adding virtual tables"
        },
        {
          "code": "java.annotation.removed",
          "old": "method java.util.UUID com.datastax.oss.driver.api.core.metadata.schema.RelationMetadata::getId() @ com.datastax.oss.driver.api.core.metadata.schema.TableMetadata",
          "new": "method java.util.Optional<java.util.UUID> com.datastax.oss.driver.api.core.metadata.schema.RelationMetadata::getId() @ com.datastax.oss.driver.api.core.metadata.schema.TableMetadata",
          "annotationType": "edu.umd.cs.findbugs.annotations.NonNull",
          "annotation": "@edu.umd.cs.findbugs.annotations.NonNull",
          "package": "com.datastax.oss.driver.api.core.metadata.schema",
          "classQualifiedName": "com.datastax.oss.driver.api.core.metadata.schema.TableMetadata",
          "classSimpleName": "TableMetadata",
          "methodName": "getId",
          "oldArchive": "com.datastax.oss:java-driver-core:jar:4.0.0-beta1",
          "elementKind": "method",
          "justification": "Adding virtual tables"
        },
        {
          "code": "java.method.addedToInterface",
          "new": "method boolean com.datastax.oss.driver.api.core.metadata.schema.TableMetadata::isVirtual()",
          "package": "com.datastax.oss.driver.api.core.metadata.schema",
          "classQualifiedName": "com.datastax.oss.driver.api.core.metadata.schema.TableMetadata",
          "classSimpleName": "TableMetadata",
          "methodName": "isVirtual",
          "newArchive": "com.datastax.oss:java-driver-core:jar:4.0.0-beta2-SNAPSHOT",
          "elementKind": "method",
          "justification": "Adding virtual tables"
        },
        {
          "code": "java.annotation.removed",
          "old": "method java.util.UUID com.datastax.oss.driver.api.core.metadata.schema.RelationMetadata::getId() @ com.datastax.oss.driver.api.core.metadata.schema.ViewMetadata",
          "new": "method java.util.Optional<java.util.UUID> com.datastax.oss.driver.api.core.metadata.schema.RelationMetadata::getId() @ com.datastax.oss.driver.api.core.metadata.schema.ViewMetadata",
          "annotationType": "edu.umd.cs.findbugs.annotations.NonNull",
          "annotation": "@edu.umd.cs.findbugs.annotations.NonNull",
          "package": "com.datastax.oss.driver.api.core.metadata.schema",
          "classQualifiedName": "com.datastax.oss.driver.api.core.metadata.schema.ViewMetadata",
          "classSimpleName": "ViewMetadata",
          "methodName": "getId",
          "oldArchive": "com.datastax.oss:java-driver-core:jar:4.0.0-beta1",
          "elementKind": "method",
          "justification": "Adding virtual tables"
        },
        {
          "code": "java.class.externalClassExposedInAPI",
          "new": "class com.datastax.oss.driver.api.core.CqlIdentifier",
          "classSimpleName": "CqlIdentifier",
          "newArchive": "com.datastax.oss:java-driver-core:jar:4.0.0-beta2-SNAPSHOT",
          "exampleUseChainInNewApi": "com.datastax.oss.driver.api.core.CqlIdentifier is used as parameter in method com.datastax.oss.driver.api.querybuilder.condition.ConditionBuilder<com.datastax.oss.driver.api.querybuilder.condition.Condition> com.datastax.oss.driver.api.querybuilder.condition.Condition::element(com.datastax.oss.driver.api.core.CqlIdentifier, com.datastax.oss.driver.api.querybuilder.term.Term) (method com.datastax.oss.driver.api.querybuilder.condition.ConditionBuilder<com.datastax.oss.driver.api.querybuilder.condition.Condition> com.datastax.oss.driver.api.querybuilder.condition.Condition::element(com.datastax.oss.driver.api.core.CqlIdentifier, com.datastax.oss.driver.api.querybuilder.term.Term) is part of the API)",
          "package": "com.datastax.oss.driver.api.core",
          "classQualifiedName": "com.datastax.oss.driver.api.core.CqlIdentifier",
          "elementKind": "class",
          "justification": "Work around revapi filtering"
        }
      ]
    }
  }
